// get upgrade percentage progress
$("#build_progress_<%= @building.id %>").val("<%= @percent %>");
<% if @building.upgrade_start.nil? %>
// trigger when upgrade_start is finished
// reload building infos
$("#building_<%= @building.id %>").html('<%= j render partial: "buildings/building_detail", :locals => {:building => @building} %>');
// cancel the ajax calls
$(function() { cancelInterval_<%= @building.id %>(); });
// update resources
$('#resources').html("<%= j (render partial: 'planets/resources', :locals => {:planet => @planet}) %>")
$('#aside_resources').html("<%= j (render partial: 'planets/production', :locals => {:planet => @planet}) %>")
<% else %>
// display the cancel btn and progres bar
$(function() { display_cancel_btn(<%= @building.id %>); });
<% end %>